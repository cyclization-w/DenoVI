# this is the full module of DenoVI experimental version
# DenoVI uses scVI and Pyro structure for inference and modeling of image-based spatial transcriptomics(Xenium, MerFISH, ...) 

import numpy as np
import torch
import torch.nn as nn
import torch.nn.functional as F
import scvi
from scvi import REGISTRY_KEYS
from scvi.data import AnnDataManager
from scvi.data.fields import CategoricalObsField, LayerField
from scvi.dataloaders import AnnDataLoader, AnnTorchDataset
from scvi.module.base import (
    BaseModuleClass,
    PyroBaseModuleClass,
    LossOutput,
    auto_move_data,
)
from scvi.module._classifier import Classifier
from scvi.nn import Encoder, DecoderSCVI
import pyro
import pyro.distributions as dist
from pyro.nn import PyroModule
from pyro.distributions import (
    Normal,
    NegativeBinomial,
    Gamma,
    Dirichlet,
    Delta,
    Poisson,
    LogNormal,
    Categorical,
    constraints,
)
from torch.distributions import kl_divergence as kl
from typing import Literal, Callable, Iterable
